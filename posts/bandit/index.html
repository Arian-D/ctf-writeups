<!doctype html><html lang=en><head><title>Bandit :: Writeups</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="I obviously did not put the passwords in, but you should be able to run the commands as the solution. There also might be multiple solutions provided to solve the same problem; pick your poison.
Level 0 This is a simple ssh login.
ssh bandit0@bandit.labs.overthewire.org -p 2220 Level 1 Use the cat command to view the content.
cat readme Level 2 A simple ./ prefix explicitly reads the file from the current directory instead of the stdin"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=http://example.org/posts/bandit/><link rel=stylesheet href=http://example.org/styles.css><link rel="shortcut icon" href=http://example.org/img/theme-colors/pink.png><link rel=apple-touch-icon href=http://example.org/img/theme-colors/pink.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Bandit"><meta property="og:description" content="I obviously did not put the passwords in, but you should be able to run the commands as the solution. There also might be multiple solutions provided to solve the same problem; pick your poison.
Level 0 This is a simple ssh login.
ssh bandit0@bandit.labs.overthewire.org -p 2220 Level 1 Use the cat command to view the content.
cat readme Level 2 A simple ./ prefix explicitly reads the file from the current directory instead of the stdin"><meta property="og:url" content="http://example.org/posts/bandit/"><meta property="og:site_name" content="Writeups"><meta property="og:image" content="http://example.org/img/favicon/pink.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"></head><body class=pink><div class="container headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Writeups</div></a></div></div></header><div class=content><article class=post><h1 class=post-title><a href=http://example.org/posts/bandit/>Bandit</a></h1><div class=post-meta><span class=post-author>[Arian]</span></div><div class=post-content><div><p>I obviously did not put the passwords in, but you should be able to
run the commands as the solution. There also might be multiple
solutions provided to solve the same problem; pick your poison.</p><h2 id=level-0>Level 0<a href=#level-0 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>This is a simple ssh login.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>ssh bandit0@bandit.labs.overthewire.org -p <span style=color:#ae81ff>2220</span>
</span></span></code></pre></div><h2 id=level-1>Level 1<a href=#level-1 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Use the <code>cat</code> command to view the content.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat readme
</span></span></code></pre></div><h2 id=level-2>Level 2<a href=#level-2 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>A simple <code>./</code> prefix explicitly reads the file from the current
directory instead of the stdin</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat ./-
</span></span></code></pre></div><h2 id=level-3>Level 3<a href=#level-3 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>If you just type <code>cat s</code> and press TAB you would see the following</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat spaces<span style=color:#ae81ff>\ </span>in<span style=color:#ae81ff>\ </span>this<span style=color:#ae81ff>\ </span>filename
</span></span></code></pre></div><p>Another simple solution is using single or double quotes</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat <span style=color:#e6db74>&#34;spaces in this filename&#34;</span>
</span></span></code></pre></div><h2 id=level-4>Level 4<a href=#level-4 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>If you type <code>cat i</code> and TAB a few times you&rsquo;ll see <code>inhere/.hidden</code> show
up.</p><p>Another way of figuring this out is just using the <code>-a</code> flag:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>ls -a inhere
</span></span></code></pre></div><p>which shows you the path of the file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat inhere/.hidden
</span></span></code></pre></div><h2 id=level-5>Level 5<a href=#level-5 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>One easy way is using <code>strings</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>strings inhere/*
</span></span></code></pre></div><p>You can see the outlier, which is the password. A better way of doing
is is a simple</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>file inhere/*
</span></span></code></pre></div><p>Which shows that only one of the files is an <code>ASCII text</code>, which then
you can read with <code>cat</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat inhere/-file07
</span></span></code></pre></div><h2 id=level-6>Level 6<a href=#level-6 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>For this one you might want to check out the man page (<code>man find</code>). If
you don&rsquo;t know, you can search through man-pages using <code>/</code>. For several
of the flags like <code>-readable</code> or <code>-type</code> this would be very necessary to know.</p><p>The quickest way to know which file it is you can simply rely on the
<code>-size</code> flag.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>file -size 1033c
</span></span></code></pre></div><p>That&rsquo;s it! You can see the content using a quick bash trick</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat <span style=color:#66d9ef>$(</span>find -size 1033c<span style=color:#66d9ef>)</span>
</span></span></code></pre></div><p>Although that&rsquo;s enough to get the solution, you can find all
non-executable human-readable files using <code>!</code> for negation, <code>xargs</code> for
running <code>du</code> (disk usage) on all files, and filtering the readable files</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>find ! -executable | xargs -I ? file ? | grep <span style=color:#e6db74>&#34;ASCII text</span>$<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><h2 id=level-7>Level 7<a href=#level-7 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>In this one size alone is not enough, so we&rsquo;ll factor in the user and
group owner:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>find / -size 33c -user bandit7 -group bandit6
</span></span></code></pre></div><p>You&rsquo;ll see a lot of <code>Permission denied</code> because as a user you can&rsquo;t see
all kind of files. In order to get rid of that you can hide standard
error by redirecting like <code>2> /dev/null</code>.</p><p>To put it all together,</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat <span style=color:#66d9ef>$(</span>find / -size 33c -user bandit7 -group bandit6 2&gt; /dev/null<span style=color:#66d9ef>)</span>
</span></span></code></pre></div><h2 id=level-8>Level 8<a href=#level-8 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>the file <code>data.txt</code> is about 98566 lines; you can find that out using
<code>wc -l data.txt</code>. This is hard to filter out with the eyes, so we&rsquo;ll
rely on <code>grep</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>grep millionth data.txt
</span></span></code></pre></div><p>That&rsquo;ll show you the password, which you can then copy and paste. If
you want to insist on <em>only</em> seeing the password and cutting out the
second part:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>grep millionth data.txt | cut -f2
</span></span></code></pre></div><h2 id=level-9>Level 9<a href=#level-9 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>First, to get the count of every line, we&rsquo;ll do this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sort data.txt | uniq -c
</span></span></code></pre></div><p>There&rsquo;s still too many lines that appeared 10 times, so we&rsquo;ll have to
<code>sort</code> again, so we&rsquo;ll do it again and only get the last line:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sort data.txt | uniq -c | sort | tail -1 | awk <span style=color:#e6db74>&#39;{print $2}&#39;</span>
</span></span></code></pre></div><h2 id=level-10>Level 10<a href=#level-10 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>First we gotta make it readable using <code>strings</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>strings data.txt
</span></span></code></pre></div><p>Then, we&rsquo;ll get the lines that <strong>start with one or more =</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>strings data.txt | egrep <span style=color:#e6db74>&#39;^\=+&#39;</span>
</span></span></code></pre></div><p>the one we need has more than 4 characters (the one besides &ldquo;the&rdquo;):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>strings data.txt | egrep <span style=color:#e6db74>&#39;^\=+ ....&#39;</span> | awk <span style=color:#e6db74>&#39;{print $2}&#39;</span>
</span></span></code></pre></div><p>Check out <a href=https://regex101.com/>https://regex101.com/</a> to learn more about regular
expressions. <code>awk</code>, however, is its own language.</p><h2 id=level-11>Level 11<a href=#level-11 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>It&rsquo;s easy to decode base64; one way is to use it is with a pipe</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat data.txt | base64 -d
</span></span></code></pre></div><p>You can read from standard input with <code>&lt;</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>base64 -d &lt; data.txt
</span></span></code></pre></div><p>Or just pass it to <code>base64</code> as an argument and read the 4th component
(the password)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>base64 -d data.txt | awk <span style=color:#e6db74>&#39;{print $4}&#39;</span>
</span></span></code></pre></div><h2 id=level-12>Level 12<a href=#level-12 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>This is a fun one. You can <a href="https://duckduckgo.com/?q=rot13+decoder&ia=answer">look up</a> websites that do it like <a href=https://cyberchef.org/>cyberchef</a>,
but if you don&rsquo;t want to exit your terminal, you can simply decode it
with python. You can launch Python by just typing <code>python3</code> and you can
use the built-in <code>codecs</code> library</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> codecs <span style=color:#f92672>import</span> decode
</span></span><span style=display:flex><span>print(decode(open(<span style=color:#e6db74>&#39;data.txt&#39;</span>)<span style=color:#f92672>.</span>read(), <span style=color:#e6db74>&#39;rot_13&#39;</span>))
</span></span></code></pre></div><h2 id=level-13>Level 13<a href=#level-13 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>As the page suggests, try using <code>xxd</code> with the <code>-r</code> flag to reverse the
hexdump.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>xxd -r data.txt &gt; /tmp/somefile
</span></span></code></pre></div><p>Calling <code>file /tmp/somefile</code> will inform us that the file is
gzip-compressed</p><p>You might think a simple <code>gzip -d /tmp/somefile</code> might work, but sadly
<code>gzip</code> will complain that we don&rsquo;t have the right file extension. To get
around this, we&rsquo;ll do use some redirection magic to <span class=underline>read</span> from the
stdin for decompressing, and <span class=underline>write</span> to another file</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>gzip -d &lt; /tmp/somefile &gt; /tmp/f1
</span></span></code></pre></div><p>Next one is bzip2, gzip again, tar, and so on. One thing the website
does <strong>not</strong> mention is that you don&rsquo;t have to create new files in
<code>/tmp</code>. One of the strengths of posix shell is the ability to rely on
pipes and stdin and stdout.</p><p>In the spirit of keeping these solutions to one-line, we can just pipe
(compose, chain, or however else you want to think about it).</p><p>Starting with</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>xxd -r data.txt | file -
</span></span></code></pre></div><p>We&rsquo;ll learn the file type, so we can move on to</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>xxd -r data.txt | gzip -d | file -
</span></span></code></pre></div><p>If we continue like so, there&rsquo;s no need to create temporary files, and
it&rsquo;ll be very neat. The deeply nested compressed file could easily be
decompressed using</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>xxd -r data.txt | gzip -d | bzip2 -d | gzip -d | tar -xO | tar -xO | bzip2 -d | tar -xO | gzip -d
</span></span></code></pre></div><h2 id=level-14>Level 14<a href=#level-14 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>This level wants to introduce you to ssh keys. Just a <code>-i</code> is enough to
get to the next level</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>ssh -i sshkey.private bandit14@localhost -p <span style=color:#ae81ff>2220</span>
</span></span></code></pre></div><h2 id=level-15>Level 15<a href=#level-15 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>This level introduces you to netcat. Take a loot at <code>man nc</code> and <code>nc -h</code>
to get a feel, but the gist of <code>nc</code> is simple:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>nc localhost <span style=color:#ae81ff>30000</span>
</span></span></code></pre></div><p>Although you can interactively send the password like this, you can
take advantage of stdin, and send it to nc:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>nc localhost <span style=color:#ae81ff>30000</span> &lt; /etc/bandit_pass/bandit14
</span></span></code></pre></div><h2 id=level-16>Level 16<a href=#level-16 class=hanchor arialabel=Anchor>&#8983;</a></h2><p>This is very similar, but with TLS. OverTheWire doesn&rsquo;t make it clear,
but to save you some time, check out <code>man openssl-s_client</code>. The
subcommand man-page is the one they&rsquo;re referring to, and just like the
<code>nc</code> command, you can redirect the file to stdin.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>openssl s_client -ign_eof localhost:30001 &lt; /etc/bandit_pass/bandit15
</span></span></code></pre></div></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2023 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>